# Робот на VLM в домашних условиях

![Для привлечения внимания](real_drive_1.gif)

## Введение

Те, кто следит за развитием ML в беспилоте, наверняка знают: в проектировании систем автономного движения существует два основных подхода — **модульный** и **сквозной (End-to-End)**. На основе первого строят рабочие проекты, на основе второго — красивые и впечатляющие презентации.

Модульный подход разделяет задачу на отдельные компоненты: детекция объектов, предсказание их движения, планирование траектории и управление. Каждый модуль оптимизируется по своей локальной метрике, что упрощает разработку и отладку, но может приводить к накоплению ошибок и потере информации между этапами обработки.

Сквозной подход объединяет все этапы в единую модель глубокого обучения, которая напрямую преобразует сырые данные сенсоров в управляющие команды. Такой подход позволяет избежать ручного проектирования признаков, обеспечивает совместную оптимизацию всех компонентов по глобальному критерию качества вождения и потенциально лучше обобщается на новые ситуации. 

Например, компания **Wayve** демонстрирует успешное применение сквозного подхода в автономном вождении. Их агент, обученный водить автомобиль в симуляции, успешно справляется с реальной дорогой. Кроме того, компания показывает интеграцию визуально-языковых моделей (Vision Language Models, или VLM) для понимания сцены и принятия решений. Посмотрите на визуализацию ниже — автопилот объясняет свои действия на понятном человеку языке:
![wave](wave.gif)

## Архитектура

{запустить VLM с частотой достаточной для даже для неспешной езды на мобилном железе робота та еще задачка. хотя бы Система состоит из двух основных компонентов, разделенных по вычислительной нагрузке.

### Хост-система

В качестве вычислительного узла используется мощный игровой ноутбук с видеокартой NVIDIA RTX 4080. Это позволяет запускать крупные модели VLM в реальном времени без необходимости облачных вычислений или специализированных серверов. Ноутбук выполняет роль "мозга" системы — на нем работает единая нейросеть, которая одновременно решает задачи восприятия окружающей среды и планирования движения.

В соответствии с принципами сквозного подхода, вместо набора отдельных модулей используется одна нейросеть — "черный ящик", который напрямую преобразует видеопоток с камеры в управляющие команды. Модель одновременно:
- **Воспринимает** окружающую среду через анализ видеокадров
- **Понимает** контекст сцены с помощью языковых возможностей VLM
- **Планирует** траекторию движения на основе понимания ситуации
- **Генерирует** управляющие команды для робота

Такая архитектура исключает необходимость промежуточных представлений (детекции объектов, семантической карты и т.д.) и позволяет модели учиться оптимальным стратегиям напрямую из опыта.

### Робот-платформа

Робот представляет собой мини-компьютер Raspberry Pi 5, оснащенный камерой и установленный на четырехколесное шасси. Raspberry Pi выполняет роль "тела" системы:
- **Собирает** видеоданные с камеры и передает их на хост по Wi-Fi
- **Получает** управляющие команды от нейросети
- **Выполняет** движения, управляя моторами колес

Разделение на хост и робот позволяет использовать мощные вычислительные ресурсы для обработки нейросети, сохраняя при этом мобильность и простоту робота-платформы. Связь между компонентами осуществляется по беспроводной сети, что обеспечивает свободу перемещения робота в домашних условиях.

